library(qgraph)
library(glasso)

library(bootnet)

library(mgm)

net.df <- perI

net.df <- net.df[net.df$Test_Nr==1,]

latI <- latI[,!names(latI)%in%c("Subject", "Batch", "Sow")]

net.df <- merge(net.df, latI, by="PVC_Nr")

names(net.df)

net.df$Subject <- NULL
net.df$Test_Nr <- NULL

str(net.df)

key <- net.df$PVC_Nr

net.df$PVC_Nr <- NULL

dim(net.df)

str(net.df)

histogram(net.df$locom_freq)

net.df$Batch <- as.integer(net.df$Batch)
                                        #net.df$Sow <- as.integer(net.df$Sow)
net.df$Sow <- NULL # removing Sow for now because the model requires at least 2 events
net.df$bias_w <- as.integer(net.df$bias_w)
net.df$bias_t <- as.integer(net.df$bias_t)
net.df$bias_f <- as.integer(net.df$bias_f)

net.type <- c("c", "p", "g", "p", "p", "g", "p", "g", "g", "g", "p", "g", "p", "g", "p", "g", "g", "p", "p", "g", "p", "p", "g", "g", "p", "p", "g", "c", "g", "c", "g", "c")

net.level <- c(5, rep(1, 26), 3, 1, 2, 1, 3)

fit.net <- mgm(data=as.matrix(net.df), type=net.type, level=net.level, k=2, lambdaSel="EBIC", lambdaGam=0.25, pbar=FALSE)

qgraph(input=fit.net$pairwise$wadj,
       nodeName=colnames(net.df))

colnames(net.df)

fit.net2 <- mgm(data=as.matrix(net.df), type=net.type, level=net.level, k=2, lambdaSel="EBIC", lambdaGam=0.4, pbar=FALSE)

### network with the only tests

### network with just bibago and laterality

fit.net


summary(fit.net)

length(net.type)
length(net.level)


results <- estimateNetwork(


    fit.net
    
